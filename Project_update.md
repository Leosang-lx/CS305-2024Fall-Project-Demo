# Project Update

##### 分工

10.2

初步跑通s-c的屏幕共享

- tcp
- jpg编码

音频与视频的传输是独立的

- 音频传输对延迟更加敏感，视频传输对带宽需求更大

Q：当网络质量下降时，如何自适应的调整对于视频和音频质量的控制？

音频的混合：

- 本地混合
  - 每个参与者的音频流都独立传输
  - 然后接收者对于多个音频源在接受后进行混合再播放
- 服务端混合
  - 首先发送到服务器，服务器对多路音频进行混合后再各自发送给各个用户
  - 问题：每个用户收到的音频不同（各自排除掉自身的音频）
- SFU
  - 服务器根据客户端需求选择转发特定的音频流
  - 只转发需要转发的音频流

Q：音频传输带宽占多少？按帧来说的话，音频就少很多了

- 图片：0.28MB
- 音频：0.002MB

10.3

s-c麦克风音频传输通过

10.8

s-c视频和摄像头视频隔离传输通过

整理client-server框架和传输部分

暂时先默认client-server传输模式

声音最好就从客户端混合好之后直接发送？

10.9

不同流数据源使用独立连接传输

暂时简单要求：

- **客户端只加入一个会议**

- **一个会议只有一个客户端能够共享屏幕**

多线程+协程管理会议IO：

- 每个会议独立一个线程管理
  - 每个会议管理线程内部使用协程管理IO转发

输出：

所有成员的摄像头：多个

屏幕分享者的屏幕：一个

所有成员的语音：多个输出混合

**先实现功能**再优化性能



asyncio怎么用啊。。。

不用的话就要好多线程，贼麻烦

10.10

server：完全转发

用udp先？

多源声音就先直接放在多个队列中，然后

每个数据都有单独自己的发送频率控制：

bonus：回放？（cache）

10.11

bug：屏幕捕捉出来的是啥玩意？

**每种数据只用一个连接从服务器接收好像也不太行感觉，服务器同时将不同用户的数据往这个连接转发，接收到的数据是不是就乱序了？**

client=2就暂时没啥问题，别的就不好说了

10.12

视频传输搞定了：本地测试完成

声音还没测

- 估计会有问题，现在是对于接收到的多个音频源的chunk，直接用streamout输出，理论上需要先混合再输出？

10.13

已完成：

- 创建会议
- 加入会议

todo：

- 退出会议
- 取消会议
- 声音测试

10.15

- 客户端退出应该通知所有人，并且对应删除原有的缓存
- 没声
  - 有个bug，解决了，但是还不确定多client输出声音对不对

- 用户cmd交互界面

10.17

处理cancel conference，异常处理，真多啊

一个client cancel了，其他client得有对应反应

说白了就是主连接关了就要自动退出会议，客户端处理连接异常

